- name: Prepare gnome desktop
  command: "/opt/flight/bin/flight desktop prepare gnome"
  async: 600
  poll: 15
  when:
    - flightenv_bootstrap
    - "'gateway' in group_names"

- name: Prepare xterm desktop
  command: "/opt/flight/bin/flight desktop prepare xterm"
  when:
    - flightenv_bootstrap
    - "'gateway' in group_names"

- name: Add gridware binary support
  file:
    path: "/opt/apps/flight/env/u"
    state: directory
    mode: 1777
  when:
    - flightenv_bootstrap
    - "'gateway' in group_names"

- name: Prewarm software environments
  unarchive:
    src: https://openflighthpc-compute.s3.eu-west-2.amazonaws.com/bootcamp/openflight-env-prereqs.tar.gz
    dest: /
    remote_src: yes
  when:
    - flightenv_bootstrap
    - "'gateway' in group_names"
